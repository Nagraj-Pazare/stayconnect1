<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>StayConnect | Find PGs Near You</title>
  <link rel="stylesheet" href="css/style.css" />
  <link rel="stylesheet" href="css/responsive.css" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
  <!-- Font Awesome for icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
</head>

<body>
  <!-- Header -->
  <div id="header-placeholder"></div>

  <!-- Hero Section with Enhanced Search -->
  <section class="hero">
    <div class="overlay">
      <div class="container text-center text-light">
        <h1 class="hero-title">Find Your Perfect Stay</h1>
        <p class="hero-subtitle">Discover verified PGs, hostels, and flats near your college or location</p>

        <!-- Enhanced Search Bar -->
        <div class="search-container">
          <div class="search-bar-wrapper">
            <div class="search-bar">
              <input type="text" id="searchInput" class="form-control search-input"
                placeholder="Enter area, college, PG name, or facilities..." autocomplete="off" />
              <button class="btn btn-light search-btn" id="searchBtn" onclick="performSearch()">
                <span id="searchText">Search</span>
                <div id="searchSpinner" class="spinner-border spinner-border-sm ms-2 d-none" role="status"></div>
              </button>
            </div>
            <!-- Search suggestions will be added here dynamically -->
          </div>

          <div class="search-actions mt-3">
            <button class="btn btn-outline-light btn-sm me-2 location-btn" onclick="useCurrentLocation()">
              <i class="fas fa-location-crosshairs"></i> Use My Location
            </button>
            <button class="btn btn-outline-light btn-sm show-all-btn" onclick="showAllPGs()">
              <i class="fas fa-sync-alt"></i> Show All PGs
            </button>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Filters Section -->
<section class="filters-section container mt-4">
    <div class="row justify-content-center">
        <div class="col-lg-10">
            <div class="filters-card card">
                <div class="card-body">
                    <h6 class="filters-title mb-3"><i class="fas fa-filter me-2"></i>Filter PGs</h6>
                    <div class="row g-3">
                        <div class="col-md-4">
                            <label class="form-label filter-label">Max Rent (â‚¹)</label>
                            <input type="number" id="maxRent" class="form-control filter-input" placeholder="Any rent" min="0" />
                        </div>
                        <div class="col-md-4">
                            <label class="form-label filter-label">Sort By</label>
                            <select id="sortBy" class="form-select filter-select">
                                <option value="newest">Newest First</option>
                                <option value="rent_low">Rent: Low to High</option>
                                <option value="rent_high">Rent: High to Low</option>
                                <option value="distance">Distance: Nearest First</option>
                            </select>
                        </div>
                        <div class="col-md-4">
                            <label class="form-label filter-label">Facilities</label>
                            <select id="facilityFilter" class="form-select filter-select">
                                <option value="">All Facilities</option>
                                <option value="WiFi">WiFi</option>
                                <option value="Food">Food</option>
                                <option value="AC">AC</option>
                                <option value="Laundry">Laundry</option>
                                <option value="Parking">Parking</option>
                                <option value="Security">Security</option>
                            </select>
                        </div>
                    </div>
                    <!-- Simple reset button only -->
                    <div class="row mt-3">
                        <div class="col-12">
                            <div class="d-flex justify-content-end">
                                <button class="btn btn-outline-secondary btn-sm" onclick="showAllPGs()">
                                    <i class="fas fa-sync-alt me-1"></i>Show All PGs
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

  <!-- Listings Section -->
  <section class="pg-list container my-5">
    <div class="section-header d-flex justify-content-between align-items-center mb-4">
      <h2 class="section-title">Available PGs</h2>
      <div id="resultsCount" class="results-count text-muted">
        <i class="fas fa-home me-1"></i><span class="count-text">Loading...</span>
      </div>
    </div>

    <!-- Loading State -->
    <div id="loadingState" class="text-center py-5">
      <div class="spinner-border text-primary" role="status">
        <span class="visually-hidden">Loading PGs...</span>
      </div>
      <p class="mt-2 text-muted">Loading available PGs...</p>
    </div>

    <!-- PG Container -->
    <div id="pgContainer" class="row g-4"></div>

    <!-- No Results State -->
    <div id="noResults" class="no-results text-center py-5 d-none">
      <div class="no-results-content">
        <i class="fas fa-search fa-3x mb-3 text-muted"></i>
        <h4 class="no-results-title">No PGs Found</h4>
        <p class="no-results-text text-muted">Try different search terms or filters</p>
        <button class="btn btn-primary mt-2" onclick="showAllPGs()">
          <i class="fas fa-sync-alt me-1"></i>Show All PGs
        </button>
      </div>
    </div>
  </section>

  <!-- Footer -->
  <div id="footer-placeholder"></div>

  <!-- Firebase SDKs -->
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-storage-compat.js"></script>

  <!-- Google Maps for search suggestions -->
  <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyB8qAgA-q9hOa4Kbn2zsPeRBZsKaWp7TfA&libraries=places"
    async defer></script>

  <!-- Config + App + Modules -->
  <script src="../config/firebaseConfig.js"></script>
  <script src="../src/js/app.js"></script>
  <script src="../src/js/utils.js"></script>
  <script src="../src/js/auth.js"></script>
  <script src="../src/js/pg.js"></script>

  <!-- Bootstrap bundle -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

  <script>
    // Load components
    (async function loadComponents() {
      try {
        const head = await fetch('../src/components/navbar.html').then(r => r.text());
        const foot = await fetch('../src/components/footer.html').then(r => r.text());
        document.getElementById('header-placeholder').innerHTML = head;
        document.getElementById('footer-placeholder').innerHTML = foot;
      } catch (err) {
        console.error('Error loading components:', err);
      }
    })();

    // Initialize when page loads
    document.addEventListener('DOMContentLoaded', function () {
      // Hide loading state when Firebase is ready
      window.addEventListener('firebaseReady', function () {
        const loadingState = document.getElementById('loadingState');
        if (loadingState) {
          loadingState.style.display = 'none';
        }
      });
    });
  </script>
</body>

</html>